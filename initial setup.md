# 初始设置
twsapi是IB的独立交易应用程序TWS和ibgateway的接口。这两个都是独立的、基于Java的交易应用程序，其设计要求使用图形用户界面进行安全的用户身份验证。因此，不支持没有GUI的任何应用程序的“无头”操作。

## 交易员工作站

我们的做市商设计的IB交易员工作站（TWS）允许交易员、投资者和机构从一个账户在全球100多个市场上交易股票、期权、期货、外汇、债券和基金。twsapi是TWS的编程接口，因此，应用程序要连接到API，首先必须有TWS或IB Gateway的运行实例。要使用API的9.72+版本，必须有TWS版本952或更高版本。

## IB网关

作为API用户TWS的替代品，IB还提供IB网关（IBGW）。从API应用程序的角度来看，IB Gateway和TWS是相同的；它们都表示一个服务器，API客户机应用程序可以在用户进行身份验证后打开socket连接。对于任一应用程序（TWS或IBGW），用户必须在登录窗口中手动输入用户名和密码。出于安全原因，不支持没有GUI的TWS或IBGW的无头会话。从用户的角度来看，IB网关可能是有利的，因为它是一个更轻的应用程序，消耗的资源减少了40%。“twib”中提供的版本与“offline”中提供的版本类似，而“offline”中不自动更新。建议定期在网站上升级到IBGW的当前版本（注意，这不需要卸载IBGW的早期版本，如果不需要，也不需要安装不同的API版本）。



TWS和IBGW均设计为每天重新启动。在合同已更改或新合同已添加的情况下，这对于执行诸如重新下载合同定义之类的功能是必需的。从974+版开始，这两个应用程序都提供了自动重新启动功能，允许应用程序每天重新启动，而无需用户干预。启用此选项后，TWS或IBGW可以从星期日运行到星期日，而无需重新验证。在周六晚上服务器重置后，需要再次输入安全凭据。



TWS相对于IBGW的优势在于，它为最终用户提供了许多工具（风险导航器、OptionTrader、BookTrader等）和图形用户界面，可用于监控账户或下订单。对于初学API的用户，建议在使用IBGW之前先熟悉TWS。



为简单起见，本指南将主要参考TWS，尽管读者应该理解，出于twsapi的目的，TWS和ibgateway是同义词。

## 登录到多个应用程序

不能使用同一用户名同时登录多个交易应用程序。但是，可以同时在不同交易应用程序中使用的帐户创建其他用户名，只要一次使用给定用户名登录的交易应用程序不超过一个。在一些其他情况下，创建其他用户名也很有用：

如果TWS或IBGW使用用于在会话期间登录到客户端门户的用户名登录，则该应用程序将无法在下次断开连接（例如服务器重置）后自动重新连接到服务器。

登录到纸面交易账户的TWS或IBGW会话如果从用于登录客户端门户的实时用户共享数据，则不会接收市场数据。

如果在这两种情况下使用不同的用户名登录到客户端门户，则不会影响TWS/IBGW会话。

需要注意的是，市场数据订阅是为每个live用户名独立设置的。

### 如何在帐户管理中添加其他用户名



